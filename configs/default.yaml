# ============================================
# Training Configuration
# ============================================
#训练数据:
#   DIV2K (800 张 2K 高清图) [1]
#   验证: DIV2K valid (100 张)
#   测试: Kodak (24 张), CLIC2020 (41 张), Tecnick (120 张)
#
# 训练策略参考:
#   [2] Ballé et al., "Variational Image Compression with a Scale
#       Hyperprior," ICLR 2018, Section 4
#   [3] Minnen et al., "Joint Autoregressive and Hierarchical
#       Priors," NeurIPS 2018
#   [4] Cheng et al., "Learned Image Compression with Discretized
#       Gaussian Mixture Likelihoods," CVPR 2020

# ----- Model -----
model:
  N: 128          # Hyper-latent channels
  M: 192          # Main latent channels

# ----- Dataset -----
data:
  # DIV2K 训练集 (800 张) [1]
  train_dir: "datasets/div2k/train"
  # DIV2K 验证集 (100 张)
  valid_dir: "datasets/div2k/valid"
  # [2] Section 4: "We randomly extract 256×256 patches"
  patch_size: 256
  num_workers: 4

# ----- Training -----
train:
  epochs: 300
  batch_size: 8
  # [2] Section 4: "We use Adam with learning rate 1e-4"
  lr: 1.0e-4
  # λ 控制率失真权衡
  # [2] Table 1: λ ∈ {0.001, 0.003, 0.01, 0.03, 0.05}
  lmbda: 0.01
  # 学习率调度: 后期降低 [2][3]
  lr_milestones: [200, 260]
  lr_gamma: 0.1
  # 梯度裁剪 [3]
  clip_max_norm: 1.0
  seed: 42

# ----- Evaluation -----
eval:
  # Kodak: 图像压缩领域黄金标准测试集 (24 张 768×512)
  kodak_dir: "datasets/kodak/test"
  # CLIC 2020 Professional (41 张 2K)
  clic_dir: "datasets/clic2020/professional"
  # Tecnick sampling (120 张, 丰富纹理)
  tecnick_dir: "datasets/tecnick/sampling"
  # 每隔多少 epoch 做一次完整评估
  eval_interval: 10

# ----- Checkpoint -----
checkpoint:
  save_dir: "checkpoints"
  save_interval: 10